package model

import "time"

type Vulnerability struct {
	Cvssv3 struct {
		Score int `json:"score"`
	} `json:"cvssv3"`
	Detail struct {
		ScanParameters struct {
			Branch string `json:"branch"`
			Custom struct {
				Params struct {
					ForceScan     bool `json:"forceScan"`
					IsIncremental bool `json:"isIncremental"`
					ProjectID     int  `json:"projectId"`
				} `json:"params"`
				Type int `json:"type"`
			} `json:"custom"`
		} `json:"scan_parameters"`
		Scanner struct {
			ID   string `json:"id"`
			Name string `json:"name"`
			Type string `json:"type"`
		} `json:"scanner"`
		Comment struct {
			LastEdited time.Time `json:"last_edited"`
			Text       string    `json:"text"`
		} `json:"comment"`
		Cs struct {
			Ok bool `json:"ok"`
		} `json:"cs"`
		Cwe struct {
			ID             string `json:"_id"`
			Classification struct {
				Owasp2017 struct {
				} `json:"owasp_2017"`
				Owasp2021 struct {
				} `json:"owasp_2021"`
				PciDss struct {
				} `json:"pci_dss"`
				Sans struct {
				} `json:"sans"`
			} `json:"classification"`
			CweID    int         `json:"cwe_id"`
			Desc     string      `json:"desc"`
			DescExt  string      `json:"desc_ext"`
			IsActive int         `json:"isActive"`
			Name     string      `json:"name"`
			ParentID int         `json:"parent_id"`
			Stride   interface{} `json:"stride"`
			Wasc     int         `json:"wasc"`
		} `json:"cwe"`
		Dast struct {
			Ok     bool `json:"ok"`
			Plugin struct {
				ID   string `json:"id"`
				Name string `json:"name"`
			} `json:"plugin"`
		} `json:"dast"`
		Iac struct {
			CommitDetail struct {
				CommitterName string `json:"committer_name"`
			} `json:"commit_detail"`
			Ok bool `json:"ok"`
		} `json:"iac"`
		Infra struct {
			CveID       string `json:"cve_id"`
			Exploitable bool   `json:"exploitable"`
			Fqdn        string `json:"fqdn"`
			IP          string `json:"ip"`
			Ok          bool   `json:"ok"`
			Os          string `json:"os"`
			Plugin      struct {
				ID   string `json:"id"`
				Name string `json:"name"`
			} `json:"plugin"`
			Port     string `json:"port"`
			Proof    string `json:"proof"`
			Protocol string `json:"protocol"`
			Service  string `json:"service"`
			Vpr      string `json:"vpr"`
		} `json:"infra"`
		Project struct {
			ID   string `json:"id"`
			Name string `json:"name"`
			Team string `json:"team"`
		} `json:"project"`
		Sast struct {
			Code      string `json:"code"`
			CodeLines []struct {
				Content    string `json:"content"`
				Number     int    `json:"number"`
				Vulnerable bool   `json:"vulnerable,omitempty"`
			} `json:"code_lines"`
			CommitDetail struct {
				CommitDiff    string `json:"commit_diff"`
				CommitLink    string `json:"commit_link"`
				CommitNo      string `json:"commit_no"`
				Committer     string `json:"committer"`
				CommitterName string `json:"committer_name"`
				Snippet       string `json:"snippet"`
			} `json:"commit_detail"`
			FileName string `json:"file_name"`
			Flow     struct {
				Nodes []struct {
					Code     string `json:"Code"`
					Filename string `json:"Filename"`
					Line     int    `json:"Line"`
					Message  string `json:"Message"`
					Name     string `json:"Name"`
				} `json:"nodes"`
			} `json:"flow"`
			Language   string `json:"language"`
			LineNumber int    `json:"line_number"`
			Ok         bool   `json:"ok"`
		} `json:"sast"`
		Sca struct {
			FileName   string      `json:"file_name"`
			License    string      `json:"license"`
			Ok         bool        `json:"ok"`
			Packages   interface{} `json:"packages"`
			References interface{} `json:"references"`
		} `json:"sca"`
	} `json:"detail"`
}
